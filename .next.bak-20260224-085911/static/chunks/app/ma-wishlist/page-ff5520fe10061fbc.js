(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8867],{63:(e,t,r)=>{"use strict";var n=r(7260);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},2050:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var n=r(5155),s=r(2619),l=r.n(s),a=r(2115),o=r(3596),i=r(9678),u=r(6159);function c(){let e=(0,u.N)(),[t,r]=(0,a.useState)(!0),[s,c]=(0,a.useState)(null),[d,m]=(0,a.useState)([]);async function h(){r(!0),c(null);try{var e,t;let r=await (0,i.v)("/api/me/wishlist"),n=await r.json();if(!r.ok){401===r.status&&(0,o.Tp)(),c(null!=(e=n.error)?e:"Impossible de charger la liste d'envies");return}m(null!=(t=n.data)?t:[])}catch(e){c("Erreur r\xe9seau")}finally{r(!1)}}if((0,a.useEffect)(()=>{h()},[]),!e)return null;async function p(e){var t,r;let n=await (0,i.v)("/api/me/wishlist",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookId:e})}),s=await n.json();if(!n.ok)return void c(null!=(t=s.error)?t:"Suppression impossible");m(null!=(r=s.data)?r:[])}return(0,n.jsxs)("main",{className:"mx-auto min-h-screen w-full max-w-5xl px-4 py-10 sm:px-6 sm:py-12",children:[(0,n.jsxs)("div",{className:"mb-6 flex flex-wrap items-center justify-between gap-2 sm:mb-8",children:[(0,n.jsx)("h1",{className:"text-2xl font-black sm:text-3xl",children:"Ma liste d'envies"}),(0,n.jsx)(l(),{href:"/mon-compte",className:"text-sm font-semibold uppercase tracking-wider hover:text-primary",children:"Retour compte"})]}),t?(0,n.jsx)("p",{className:"text-sm text-[#6b6959]",children:"Chargement..."}):null,s?(0,n.jsx)("p",{className:"rounded-lg border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:s}):null,t||s||0!==d.length?null:(0,n.jsx)("div",{className:"rounded-xl border border-[#e5e5e0] bg-white p-6",children:"Votre liste d'envies est vide."}),(0,n.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:d.map(e=>{var t,r,s,a,o;return(0,n.jsxs)("article",{className:"rounded-xl border border-[#e5e5e0] bg-white p-4",children:[e.coverImage?(0,n.jsx)("img",{src:e.coverImage,alt:null!=(r=e.title)?r:"Ouvrage",className:"mb-3 h-52 w-full rounded object-cover"}):null,(0,n.jsx)("h2",{className:"text-lg font-black",children:null!=(s=e.title)?s:"Ouvrage"}),(0,n.jsx)("p",{className:"text-sm text-[#6b6959]",children:null!=(a=e.authorName)?a:"Auteur"}),(0,n.jsxs)("p",{className:"mt-2 text-sm font-bold",children:[null!=(o=null==(t=e.price)?void 0:t.toFixed(2))?o:"0.00"," â‚¬"]}),(0,n.jsxs)("div",{className:"mt-4 flex items-center gap-2",children:[e.slug?(0,n.jsx)(l(),{href:"/ouvrages/".concat(e.slug),className:"rounded border border-[#d8d7d0] px-3 py-2 text-xs font-bold uppercase",children:"Voir"}):null,(0,n.jsx)("button",{type:"button",onClick:()=>void p(e.id),className:"rounded bg-primary px-3 py-2 text-xs font-bold uppercase",children:"Retirer"})]})]},e.id)})})]})}},3596:(e,t,r)=>{"use strict";r.d(t,{NR:()=>s,Tp:()=>a,_5:()=>o,c4:()=>l});let n="livreo_auth_token";function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"local";if("session"===t){window.sessionStorage.setItem(n,e),window.localStorage.removeItem(n);return}window.localStorage.setItem(n,e),window.sessionStorage.removeItem(n)}function l(){let e=window.sessionStorage.getItem(n);return e||window.localStorage.getItem(n)}function a(){window.localStorage.removeItem(n),window.sessionStorage.removeItem(n)}function o(){let e=l();if(!e)return null;let t=e.split(".");if(3!==t.length||!t[1])return null;try{let e=JSON.parse(function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=t+"=".repeat((4-t.length%4)%4);return window.atob(r)}(t[1]));if(e.exp<=Math.floor(Date.now()/1e3))return null;return e}catch(e){return null}}},4835:(e,t,r)=>{"use strict";function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/";return!e||!e.startsWith("/")||e.startsWith("//")?t:e}r.d(t,{o:()=>n})},6035:(e,t,r)=>{Promise.resolve().then(r.bind(r,2050))},6159:(e,t,r)=>{"use strict";r.d(t,{N:()=>o});var n=r(2115),s=r(63),l=r(3596),a=r(4835);function o(){let e=(0,s.usePathname)(),t=(0,s.useSearchParams)(),[r,o]=(0,n.useState)(!1),i=t.toString();return(0,n.useEffect)(()=>{if((0,l._5)())return void o(!0);o(!1);let t=null!=e?e:"/",r=(0,a.o)("".concat(t).concat(i?"?".concat(i):""),t);window.location.replace("/connexion?next=".concat(encodeURIComponent(r)))},[r,e,i]),r}},9678:(e,t,r)=>{"use strict";r.d(t,{v:()=>s});var n=r(3596);async function s(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=(0,n.c4)(),l=new Headers(null!=(t=r.headers)?t:{});return s&&l.set("Authorization","Bearer ".concat(s)),fetch(e,{...r,headers:l})}}},e=>{e.O(0,[2619,8441,1255,7358],()=>e(e.s=6035)),_N_E=e.O()}]);