(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{63:(e,t,n)=>{"use strict";var r=n(7260);n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}}),n.o(r,"useSearchParams")&&n.d(t,{useSearchParams:function(){return r.useSearchParams}})},361:(e,t,n)=>{"use strict";n.d(t,{default:()=>c});var r=n(5155),o=n(2619),s=n.n(o),i=n(2115),a=n(63),l=n(3596),u=n(4835);function c(e){let{showAuthLinks:t=!1}=e,n=(0,a.usePathname)(),[o,c]=(0,i.useState)(!1),[d,m]=(0,i.useState)(null),[f,h]=(0,i.useState)(null),p=(0,i.useRef)(null),x=encodeURIComponent((0,u.o)(n,"/"));return((0,i.useEffect)(()=>{var e,t;let n=(0,l._5)();m(null!=(e=null==n?void 0:n.name)?e:null),h(null!=(t=null==n?void 0:n.role)?t:null)},[]),(0,i.useEffect)(()=>{function e(e){p.current&&e.target instanceof Node&&!p.current.contains(e.target)&&c(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),("admin"!==f||n.startsWith("/admin"))&&d)?(0,r.jsxs)("div",{ref:p,className:"relative",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>c(e=>!e),className:"flex h-10 items-center gap-2 rounded-lg border border-primary bg-primary/90 px-3 text-sm font-semibold text-[#181810] shadow-sm transition hover:bg-primary",children:[(0,r.jsx)("span",{className:"material-symbols-outlined text-base",children:"person"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:d}),(0,r.jsx)("span",{className:"material-symbols-outlined text-base",children:"expand_more"})]}),o?(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-52 overflow-hidden rounded-xl border border-[#e5e5e0] bg-white shadow-lg",children:[(0,r.jsx)("div",{className:"border-b border-[#f0efe9] px-4 py-3 text-xs font-bold uppercase tracking-widest text-[#8d895e]",children:"Mon compte"}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)(s(),{href:"admin"===f?"/admin":"/mon-compte",className:"flex items-center gap-3 px-4 py-3 text-sm text-[#181810] transition hover:bg-[#f8f8f5]",onClick:()=>c(!1),children:[(0,r.jsx)("span",{className:"material-symbols-outlined text-base text-[#8d895e]",children:"person"}),"Mon profil"]}),(0,r.jsxs)("button",{type:"button",onClick:function(){(0,l.Tp)(),m(null),h(null),c(!1),fetch("/api/auth/logout",{method:"POST",keepalive:!0}),window.location.replace("/")},className:"flex items-center gap-3 px-4 py-3 text-sm text-red-600 transition hover:bg-[#fef2f2]",children:[(0,r.jsx)("span",{className:"material-symbols-outlined text-base",children:"logout"}),"D\xe9connexion"]})]})]}):null]}):t?(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(s(),{href:"/connexion?next=".concat(x,"&from=home"),className:"text-sm font-semibold uppercase tracking-wider text-[#181810] transition-colors hover:text-primary",children:"connexion"}),(0,r.jsx)(s(),{href:"/inscription?next=".concat(x,"&from=home"),className:"text-sm font-semibold uppercase tracking-wider text-[#181810] transition-colors hover:text-primary",children:"inscription"})]}):null}},1362:(e,t,n)=>{"use strict";n.d(t,{default:()=>u});var r=n(5155),o=n(2619),s=n.n(o),i=n(2115),a=n(5668),l=n(3596);function u(){let[e,t]=(0,i.useState)(0);return(0,i.useEffect)(()=>{let e=()=>{(0,l._5)()?t((0,a.je)().length):t(0)};e();let n=window.setInterval(e,700);return()=>window.clearInterval(n)},[]),(0,r.jsxs)(s(),{href:"/panier",className:"relative flex h-10 w-10 items-center justify-center rounded-lg bg-[#f5f4f0] text-[#181810] transition-colors hover:bg-primary","aria-label":"Panier",children:[(0,r.jsx)("span",{className:"material-symbols-outlined",children:"shopping_bag"}),(0,r.jsx)("span",{className:"absolute -right-1 -top-1 rounded-full border-2 border-white bg-primary px-1.5 py-0.5 text-[10px] font-bold text-black",children:e})]})}},3115:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,2619,23)),Promise.resolve().then(n.bind(n,6911)),Promise.resolve().then(n.bind(n,1362)),Promise.resolve().then(n.bind(n,361)),Promise.resolve().then(n.bind(n,4988))},3596:(e,t,n)=>{"use strict";n.d(t,{NR:()=>o,Tp:()=>i,_5:()=>a,c4:()=>s});let r="livreo_auth_token";function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"local";if("session"===t){window.sessionStorage.setItem(r,e),window.localStorage.removeItem(r);return}window.localStorage.setItem(r,e),window.sessionStorage.removeItem(r)}function s(){let e=window.sessionStorage.getItem(r);return e||window.localStorage.getItem(r)}function i(){window.localStorage.removeItem(r),window.sessionStorage.removeItem(r)}function a(){let e=s();if(!e)return null;let t=e.split(".");if(3!==t.length||!t[1])return null;try{let e=JSON.parse(function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),n=t+"=".repeat((4-t.length%4)%4);return window.atob(n)}(t[1]));if(e.exp<=Math.floor(Date.now()/1e3))return null;return e}catch(e){return null}}},4835:(e,t,n)=>{"use strict";function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/";return!e||!e.startsWith("/")||e.startsWith("//")?t:e}n.d(t,{o:()=>r})},4988:(e,t,n)=>{"use strict";n.d(t,{default:()=>u});var r=n(5155),o=n(63),s=n(2115),i=n(9678),a=n(3596),l=n(4835);function u(e){let{bookId:t}=e,n=(0,o.useRouter)(),[u,c]=(0,s.useState)(null);async function d(){if(!(0,a._5)()){let e=(0,l.o)("/mon-compte?section=wishlist","/mon-compte");n.push("/connexion?next=".concat(encodeURIComponent(e)));return}let e=await (0,i.v)("/api/me/wishlist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookId:t})}),r=await e.json();if(!e.ok){var o;c(null!=(o=r.error)?o:"Impossible d'ajouter \xe0 la liste d'envies");return}c("Ajout\xe9 \xe0 la liste d'envies")}return(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsx)("button",{onClick:()=>void d(),className:"rounded-lg border border-[#d8d7d0] bg-white px-4 py-2 text-xs font-bold uppercase tracking-wider",children:"Ajouter \xe0 la liste d'envies"}),u?(0,r.jsx)("p",{className:"mt-2 text-xs text-[#8d895e]",children:u}):null]})}},5668:(e,t,n)=>{"use strict";n.d(t,{AR:()=>a,SM:()=>l,bE:()=>i,cr:()=>c,hs:()=>d,je:()=>o,yA:()=>u});let r="livreo_cart";function o(){try{let e=window.localStorage.getItem(r);if(!e)return[];let t=JSON.parse(e);if(!Array.isArray(t))return[];return t}catch(e){return[]}}function s(e){window.localStorage.setItem(r,JSON.stringify(e))}function i(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=o();return s(t=r.find(t=>t.bookId===e.bookId)?r.map(t=>t.bookId===e.bookId?{...t,quantity:Math.max(1,t.quantity+n)}:t):[...r,{...e,quantity:Math.max(1,n)}]),t}function a(e,t){let n=Math.max(1,t),r=o().map(t=>t.bookId===e?{...t,quantity:n}:t);return s(r),r}function l(e){let t=o().filter(t=>t.bookId!==e);return s(t),t}function u(){s([])}function c(e){return e.reduce((e,t)=>e+t.quantity,0)}function d(e){return e.reduce((e,t)=>e+t.price*t.quantity,0)}},6911:(e,t,n)=>{"use strict";n.d(t,{default:()=>u});var r=n(5155),o=n(2115),s=n(63),i=n(5668),a=n(3596),l=n(4835);function u(e){let{book:t,quantity:n=1,disabled:u,className:c,outOfStockLabel:d="RUPTURE DE STOCK"}=e,m=(0,s.useRouter)(),[f,h]=(0,o.useState)(!1);return(0,r.jsx)("button",{type:"button",disabled:u,onClick:function(){if(!(0,a._5)()){let e=(0,l.o)("/panier","/panier");m.push("/connexion?next=".concat(encodeURIComponent(e),"&from=cart"));return}(0,i.bE)(t,n),h(!0),window.setTimeout(()=>h(!1),1500),m.push("/panier")},className:c,children:u?d:f?"AJOUT\xc9":"AJOUTER AU PANIER"})}},9678:(e,t,n)=>{"use strict";n.d(t,{v:()=>o});var r=n(3596);async function o(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=(0,r.c4)(),s=new Headers(null!=(t=n.headers)?t:{});return o&&s.set("Authorization","Bearer ".concat(o)),fetch(e,{...n,headers:s})}}},e=>{e.O(0,[2619,8441,1255,7358],()=>e(e.s=3115)),_N_E=e.O()}]);