exports.id=1249,exports.ids=[1249],exports.modules={214:(a,b,c)=>{"use strict";c.d(b,{v:()=>e});var d=c(25174);async function e(a,b={}){let c=(0,d.c4)(),f=new Headers(b.headers??{});return c&&f.set("Authorization",`Bearer ${c}`),fetch(a,{...b,headers:f})}},9185:()=>{},10701:(a,b,c)=>{"use strict";function d(a,b="/"){return!a||!a.startsWith("/")||a.startsWith("//")?b:a}c.d(b,{o:()=>d})},24182:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,54160,23)),Promise.resolve().then(c.t.bind(c,31603,23)),Promise.resolve().then(c.t.bind(c,68495,23)),Promise.resolve().then(c.t.bind(c,75170,23)),Promise.resolve().then(c.t.bind(c,77526,23)),Promise.resolve().then(c.t.bind(c,78922,23)),Promise.resolve().then(c.t.bind(c,29234,23)),Promise.resolve().then(c.t.bind(c,12263,23)),Promise.resolve().then(c.bind(c,82146))},25174:(a,b,c)=>{"use strict";function d(a,b="local"){}function e(){return null}function f(){}function g(){let a=e();if(!a)return null;let b=a.split(".");if(3!==b.length||!b[1])return null;try{let a=JSON.parse(function(a){let b=a.replace(/-/g,"+").replace(/_/g,"/"),c=b+"=".repeat((4-b.length%4)%4);return window.atob(c)}(b[1]));if(a.exp<=Math.floor(Date.now()/1e3))return null;return a}catch{return null}}c.d(b,{NR:()=>d,Tp:()=>f,_5:()=>g,c4:()=>e})},35026:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>q});var d=c(21124),e=c(3991),f=c.n(e),g=c(38301),h=c(42378),i=c(214),j=c(25174),k=c(10701);function l(a){return a.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/[^a-z0-9\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"").slice(0,120)}let m=["pending","paid","cancelled","refunded"],n=["pending","paid","refunded"],o=["client","admin"],p=[{key:"dashboard",label:"Tableau de bord",icon:"dashboard",href:"/admin"},{key:"ouvrages",label:"Ouvrages",icon:"menu_book",href:"/admin/ouvrages"},{key:"users",label:"Utilisateurs",icon:"group",href:"/admin/users"},{key:"orders",label:"Commandes",icon:"receipt_long",href:"/admin/orders"},{key:"contributions",label:"Contributions",icon:"rocket_launch",href:"/admin/contributions"},{key:"marketing",label:"Marketing",icon:"local_offer",href:"/admin/marketing"}];function q(){let a=(0,h.usePathname)(),b=(0,h.useRouter)(),c=(0,h.useSearchParams)(),[e,q]=(0,g.useState)(!0),[B,C]=(0,g.useState)(null),[D,E]=(0,g.useState)(null),[F,G]=(0,g.useState)(null),[H,I]=(0,g.useState)([]),[J,K]=(0,g.useState)([]),[L,M]=(0,g.useState)([]),[N,O]=(0,g.useState)([]),[P,Q]=(0,g.useState)([]),[R,S]=(0,g.useState)([]),[T,U]=(0,g.useState)({code:"",type:"percent",value:"",minSubtotal:"0",maxDiscount:"",usageLimit:"",expiresAt:""}),[V,W]=(0,g.useState)({title:"",slug:"",subtitle:"",description:"",price:"",saleType:"direct",releaseDate:"",isbn:"",coverVariant:"standard",stock:"",fundingGoal:"",fundingRaised:"0"}),[X,Y]=(0,g.useState)(!1),[Z,$]=(0,g.useState)({users:"",orders:"",contributions:"",ouvrages:"",promos:""}),[_,aa]=(0,g.useState)({users:1,orders:1,contributions:1,ouvrages:1,promos:1}),ab=(0,g.useMemo)(()=>a.startsWith("/admin/ouvrages")?"ouvrages":a.startsWith("/admin/users")?"users":a.startsWith("/admin/orders")?"orders":a.startsWith("/admin/contributions")?"contributions":a.startsWith("/admin/marketing")?"marketing":"dashboard",[a]),ac={dashboard:{title:"Tableau de bord",subtitle:"Vue globale de l'interface d'administration SENALE EDITION'S"},ouvrages:{title:"Ouvrages",subtitle:"Ajout, \xe9dition et suivi du catalogue"},users:{title:"Utilisateurs",subtitle:"Comptes, r\xf4les et permissions"},orders:{title:"Commandes",subtitle:"Historique et statut des commandes"},contributions:{title:"Contributions",subtitle:"Campagnes participatives et suivi des soutiens"},marketing:{title:"Marketing",subtitle:"Codes promo, newsletters et relances"}}[ab],ad=(0,g.useMemo)(()=>J.filter(a=>"pending"===a.status).length,[J]),ae=(0,g.useMemo)(()=>J.slice(0,4),[J]),af=F?.campaignFunding?.[0]??null,ag=(0,g.useMemo)(()=>H.filter(a=>`${a.name} ${a.email} ${a.role}`.toLowerCase().includes(Z.users.toLowerCase())),[H,Z.users]),ah=(0,g.useMemo)(()=>J.filter(a=>`${a.id} ${a.userId} ${a.saleType} ${a.status}`.toLowerCase().includes(Z.orders.toLowerCase())),[J,Z.orders]),ai=(0,g.useMemo)(()=>L.filter(a=>`${a.id} ${a.bookId} ${a.userId??""} ${a.status} ${a.reward??""}`.toLowerCase().includes(Z.contributions.toLowerCase())),[L,Z.contributions]),aj=(0,g.useMemo)(()=>N.filter(a=>`${a.title} ${a.slug} ${a.saleType}`.toLowerCase().includes(Z.ouvrages.toLowerCase())),[N,Z.ouvrages]),ak=(0,g.useMemo)(()=>P.filter(a=>`${a.code} ${a.type} ${a.value} ${a.active?"active":"inactive"}`.toLowerCase().includes(Z.promos.toLowerCase())),[P,Z.promos]),al=r(ag,_.users,8),am=r(ah,_.orders,8),an=r(ai,_.contributions,8),ao=r(aj,_.ouvrages,8),ap=r(ak,_.promos,8);async function aq(){q(!0),C(null);let d=(0,j._5)();if(!d){let d=c.toString(),e=(0,k.o)(`${a}${d?`?${d}`:""}`,"/admin");b.replace(`/connexion?next=${encodeURIComponent(e)}`);return}if("admin"!==d.role){C("Acc\xe8s refus\xe9: r\xf4le admin requis."),q(!1);return}try{let[a,b,c,d,e,f,g]=await Promise.all([(0,i.v)("/api/admin/stats"),(0,i.v)("/api/admin/users"),(0,i.v)("/api/admin/orders"),(0,i.v)("/api/admin/contributions"),(0,i.v)("/api/admin/books"),(0,i.v)("/api/admin/promos"),(0,i.v)("/api/admin/audit")]),[h,j,k,l,m,n,o]=await Promise.all([a.json(),b.json(),c.json(),d.json(),e.json(),f.json(),g.json()]);if(!a.ok||!b.ok||!c.ok||!d.ok||!e.ok||!f.ok||!g.ok){C(h.error||j.error||k.error||l.error||m.error||n.error||o.error||"Erreur de chargement admin"),q(!1);return}G(h.data??null),I(j.data??[]),K(k.data??[]),M(l.data??[]),O(m.data??[]),Q(n.data??[]),S(o.data??[])}catch{C("Erreur r\xe9seau")}finally{q(!1)}}async function ar(a,b){let c=await (0,i.v)(`${a}?format=csv`);if(!c.ok)return void E((await c.json()).error??"Export CSV impossible");let d=new Blob([await c.text()],{type:"text/csv;charset=utf-8;"}),e=URL.createObjectURL(d),f=document.createElement("a");f.href=e,f.download=b,document.body.appendChild(f),f.click(),f.remove(),URL.revokeObjectURL(e)}async function as(){let a=await (0,i.v)("/api/admin/notifications/run",{method:"POST"}),b=await a.json();if(!a.ok||!b.data)return void E(b.error??"Ex\xe9cution des notifications impossible");E(`Notifications envoy\xe9es: pr\xe9commandes ${b.data.preorderEmailsSent}, campagnes ${b.data.campaignEmailsSent}`),aq()}async function at(a,b){let c=await (0,i.v)("/api/admin/users",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a,role:b})}),d=await c.json();if(!c.ok||!d.data)return void E(d.error??"Impossible de mettre \xe0 jour le r\xf4le");I(b=>b.map(b=>b.id===a?d.data:b)),E("R\xf4le utilisateur mis \xe0 jour")}async function au(a,b){let c=await (0,i.v)("/api/admin/orders",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:a,status:b})}),d=await c.json();if(!c.ok||!d.data)return void E(d.error??"Impossible de mettre \xe0 jour la commande");K(b=>b.map(b=>b.id===a?d.data:b)),E("Statut de commande mis \xe0 jour")}async function av(a,b){let c=await (0,i.v)("/api/admin/contributions",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({contributionId:a,status:b})}),d=await c.json();if(!c.ok||!d.data)return void E(d.error??"Impossible de mettre \xe0 jour la contribution");M(b=>b.map(b=>b.id===a?d.data:b)),E("Contribution mise \xe0 jour")}async function aw(a){let b=await (0,i.v)("/api/admin/books",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookId:a})}),c=await b.json();if(!b.ok||!c.data)return void E(c.error??"Impossible de supprimer l'ouvrage");O(a=>a.filter(a=>a.id!==c.data.id)),E("Ouvrage supprim\xe9")}async function ax(a){a.preventDefault();let b=await (0,i.v)("/api/admin/promos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:T.code,type:T.type,value:Number(T.value),minSubtotal:Number(T.minSubtotal||"0"),maxDiscount:T.maxDiscount?Number(T.maxDiscount):void 0,usageLimit:T.usageLimit?Number(T.usageLimit):void 0,expiresAt:T.expiresAt||void 0})}),c=await b.json();if(!b.ok||!c.data)return void E(c.error??"Impossible de cr\xe9er le code promo");Q(a=>[c.data,...a]),U({code:"",type:"percent",value:"",minSubtotal:"0",maxDiscount:"",usageLimit:"",expiresAt:""}),E("Code promo cr\xe9\xe9")}async function ay(a){let b=await (0,i.v)("/api/admin/promos",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({promoId:a.id,active:!a.active})}),c=await b.json();if(!b.ok||!c.data)return void E(c.error??"Impossible de mettre \xe0 jour le code promo");Q(b=>b.map(b=>b.id===a.id?c.data:b)),E("Code promo mis \xe0 jour")}async function az(a){if(a.preventDefault(),("direct"===V.saleType||"preorder"===V.saleType)&&""===V.stock.trim())return void E("Le stock est obligatoire pour Achat direct / Pr\xe9commande.");if("crowdfunding"===V.saleType&&""===V.fundingGoal.trim())return void E("L'objectif de financement est obligatoire pour le financement participatif.");let b=function({title:a,subtitle:b,saleType:c,variant:d}){let e=a.trim()||"Nouvel ouvrage",f=(b??"").trim(),g=u(c),h=e.split(/\s+/).slice(0,6),i=h.slice(0,Math.ceil(h.length/2)).join(" "),j=h.slice(Math.ceil(h.length/2)).join(" ");if("featured"===d){let a=`
<svg xmlns="http://www.w3.org/2000/svg" width="900" height="1350" viewBox="0 0 900 1350">
  <defs>
    <style>
      .brand-small { font: 500 16px Manrope, Arial, sans-serif; fill: #6b7280; letter-spacing: 1px; }
      .brand-main { font: 800 58px Manrope, Arial, sans-serif; fill: #111111; }
      .meta { font: 700 22px Manrope, Arial, sans-serif; fill: #4b5563; letter-spacing: 2px; }
      .footer { font: 700 12px Manrope, Arial, sans-serif; fill: #111111; letter-spacing: 3px; }
    </style>
  </defs>
  <rect x="0" y="0" width="900" height="1350" fill="#ececec"/>
  <rect x="12" y="12" width="876" height="1326" fill="none" stroke="#ced70d" stroke-width="8"/>
  <text x="280" y="92" class="brand-small">${v("SEYDOU KOFFI ABODJINOU")}</text>
  <text x="548" y="92" class="brand-small">${v("Sename d'Afrique")}</text>
  <text x="512" y="248" class="brand-small" style="font-size:56px;font-weight:700;fill:#6b7280;">sename</text>
  <foreignObject x="140" y="350" width="620" height="340">
    <div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;flex-direction:column;gap:6px;">
      <div style="font:700 72px Manrope, Arial, sans-serif;line-height:1.02;color:#111111;">${v(i)}</div>
      <div style="font:800 88px Manrope, Arial, sans-serif;line-height:1.02;color:#111111;">${v(j||e)}</div>
      <div style="margin-top:14px;font:600 50px Manrope, Arial, sans-serif;color:#b7b7b7;letter-spacing:2px;">${v(f||"CARNETS DE CONFINEMENT")}</div>
    </div>
  </foreignObject>
  <text x="190" y="760" class="meta">#1. RESTAURER LE R\xc9EL   #2. DYSTOPIE CONCR\xc8TE</text>
  <text x="450" y="1140" class="footer" text-anchor="middle">${v(g.toUpperCase())}</text>
  <text x="450" y="1166" class="footer" text-anchor="middle">ESSAI</text>
  <text x="450" y="1192" class="footer" text-anchor="middle">LITT\xc9RAIRE</text>
  <rect x="430" y="1225" width="40" height="40" fill="#111"/>
  <text x="800" y="1295" class="brand-small">51</text>
</svg>`;return`data:image/svg+xml;charset=utf-8,${encodeURIComponent(a)}`}let k=`
<svg xmlns="http://www.w3.org/2000/svg" width="900" height="1350" viewBox="0 0 900 1350">
  <defs>
    <style>
      .brand-small { font: 700 34px Manrope, Arial, sans-serif; fill: #111111; letter-spacing: 1px; }
      .title { font: 800 84px Manrope, Arial, sans-serif; fill: #3f3f46; }
      .subtitle { font: 600 30px Manrope, Arial, sans-serif; fill: #444; }
      .meta { font: 700 14px Manrope, Arial, sans-serif; fill: #4b5563; letter-spacing: 3px; }
    </style>
  </defs>
  <rect x="0" y="0" width="900" height="1350" fill="#ececec"/>
  <rect x="0" y="0" width="900" height="18" fill="#ced70d"/>
  <text x="450" y="96" class="brand-small" text-anchor="middle">sename</text>
  <foreignObject x="140" y="360" width="620" height="360">
    <div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;flex-direction:column;gap:12px;align-items:center;text-align:center;">
      <div style="font:800 84px Manrope, Arial, sans-serif;line-height:1.1;color:#3f3f46;word-wrap:break-word;">
        ${v(i)}
      </div>
      <div style="font:800 84px Manrope, Arial, sans-serif;line-height:1.1;color:#3f3f46;word-wrap:break-word;">
        ${v(j)}
      </div>
      <div style="font:600 30px Manrope, Arial, sans-serif;line-height:1.3;color:#444;">${v(f||"Livre d'une sortie au jour")}</div>
    </div>
  </foreignObject>
  <text x="450" y="860" class="meta" text-anchor="middle">${v(g.toUpperCase())}</text>
  <text x="450" y="886" class="meta" text-anchor="middle">ESSAI</text>
  <text x="450" y="912" class="meta" text-anchor="middle">LITT\xc9RAIRE</text>
  <rect x="430" y="960" width="40" height="40" fill="#111"/>
  <text x="850" y="1310" class="meta">1</text>
</svg>`;return`data:image/svg+xml;charset=utf-8,${encodeURIComponent(k)}`}({title:V.title,subtitle:V.subtitle,saleType:V.saleType,variant:V.coverVariant}),c={title:V.title,description:V.description,price:Number(V.price),saleType:V.saleType,coverImage:b};V.slug.trim()&&(c.slug=V.slug.trim()),V.subtitle.trim()&&(c.subtitle=V.subtitle.trim()),V.releaseDate&&(c.releaseDate=V.releaseDate),V.isbn.trim()&&(c.isbn=V.isbn.trim()),"featured"===V.coverVariant&&(c.tags=["featured"]),""!==V.stock.trim()&&(c.stock=Number(V.stock)),""!==V.fundingGoal.trim()&&(c.fundingGoal=Number(V.fundingGoal)),""!==V.fundingRaised.trim()&&(c.fundingRaised=Number(V.fundingRaised));let d=await (0,i.v)("/api/books",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),e=await d.json();if(!d.ok)return void E(e.error??"Impossible de cr\xe9er l'ouvrage");W({title:"",slug:"",subtitle:"",description:"",price:"",saleType:"direct",releaseDate:"",isbn:"",coverVariant:"standard",stock:"",fundingGoal:"",fundingRaised:"0"}),Y(!1),E("Ouvrage cr\xe9\xe9"),aq()}return(0,d.jsx)("main",{className:"min-h-screen bg-[#f3f4f6] text-[#181810] md:h-screen md:overflow-hidden",children:(0,d.jsxs)("div",{className:"flex min-h-screen flex-col md:h-screen md:flex-row",children:[(0,d.jsxs)("aside",{className:"w-full border-b border-[#e5e7eb] bg-white p-4 sm:p-5 md:w-72 md:border-b-0 md:border-r md:h-screen md:shrink-0 md:overflow-y-auto",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("div",{className:"flex size-8 items-center justify-center rounded-full bg-black text-primary",children:(0,d.jsx)("span",{className:"material-symbols-outlined text-xl",children:"menu_book"})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{className:"text-base font-extrabold uppercase leading-tight tracking-tight text-[#181810] sm:text-lg",children:"SENAME EDITION’S"}),(0,d.jsx)("p",{className:"text-xs font-semibold text-[#6b7280] uppercase tracking-wide mt-1",children:"administration"})]})]}),(0,d.jsx)("nav",{className:"mt-6 space-y-2",children:p.map(a=>(0,d.jsxs)(f(),{href:a.href,className:`flex w-full items-center gap-3 rounded-xl px-4 py-3 text-left text-sm font-semibold transition ${ab===a.key?"bg-primary text-black":"text-[#4b5563] hover:bg-[#f4f5f7]"}`,children:[(0,d.jsx)("span",{className:"material-symbols-outlined text-lg",children:a.icon}),(0,d.jsx)("span",{children:a.label})]},a.key))}),(0,d.jsx)("div",{className:"mt-10",children:(0,d.jsxs)("button",{type:"button",onClick:function(){(0,j.Tp)(),fetch("/api/auth/logout",{method:"POST",keepalive:!0}),window.location.replace("/")},className:"flex w-full items-center justify-center gap-2 rounded-lg border border-red-200 bg-white px-4 py-3 text-sm font-semibold text-red-600 transition hover:bg-[#fef2f2]",children:[(0,d.jsx)("span",{className:"material-symbols-outlined text-base",children:"logout"}),"D\xe9connexion"]})})]}),(0,d.jsxs)("section",{className:"flex-1 p-4 sm:p-6 md:p-8 md:h-screen md:overflow-y-auto",children:[(0,d.jsx)("header",{className:"mb-6 flex items-center justify-between",children:(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{className:"text-2xl font-black sm:text-3xl",children:ac.title}),(0,d.jsx)("p",{className:"text-sm text-[#6b7280]",children:ac.subtitle})]})}),e?(0,d.jsx)("p",{className:"text-sm text-[#6b7280]",children:"Chargement..."}):null,B?(0,d.jsx)("p",{className:"rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:B}):null,D?(0,d.jsx)("p",{className:"mb-4 rounded-xl border border-[#e5e7eb] bg-white px-4 py-3 text-sm",children:D}):null,e||B||!F?null:(0,d.jsxs)("div",{className:"space-y-6",children:["dashboard"===ab?(0,d.jsxs)("div",{className:"space-y-8",children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,d.jsx)(y,{icon:"group",label:"Utilisateurs",value:F.usersCount}),(0,d.jsx)(y,{icon:"receipt_long",label:"Commandes",value:F.ordersCount}),(0,d.jsx)(y,{icon:"rocket_launch",label:"Contributions",value:F.contributionsCount}),(0,d.jsx)(y,{icon:"euro",label:"Chiffre d'affaires",value:`${F.paidRevenue.toFixed(2)} €`})]}),(0,d.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[2fr_1fr]",children:[(0,d.jsxs)("div",{className:"rounded-2xl border border-[#e5e7eb] bg-white p-6",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{className:"text-2xl font-black",children:"Campagne crowdfunding"}),(0,d.jsx)("p",{className:"text-sm text-[#6b7280]",children:"Suivi des collectes et campagnes actives"})]}),(0,d.jsx)("button",{type:"button",onClick:()=>void as(),className:"rounded-lg bg-primary px-3 py-2 text-xs font-bold uppercase",children:"Ex\xe9cuter notifications"})]}),(0,d.jsx)("div",{className:"mt-6 space-y-5",children:af?(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm font-semibold text-[#181810]",children:af.title}),(0,d.jsxs)("span",{className:"text-xs text-[#6b7280]",children:[Math.min(af.collected/af.goal*100,100).toFixed(0),"%"]})]}),(0,d.jsx)("div",{className:"h-2 rounded-full bg-[#f2f3f5]",children:(0,d.jsx)("div",{className:"h-2 rounded-full bg-primary",style:{width:`${Math.min(af.collected/af.goal*100,100)}%`}})}),(0,d.jsxs)("p",{className:"text-xs text-[#6b7280] mt-2",children:[af.collected.toFixed(2)," € collect\xe9s / ",af.goal.toFixed(2)," € objectif"]})]}):(0,d.jsx)("p",{className:"text-sm text-[#6b7280]",children:"Aucune campagne en cours."})})]}),(0,d.jsxs)("div",{className:"rounded-2xl border border-[#e5e7eb] bg-white p-6",children:[(0,d.jsx)("h2",{className:"text-2xl font-black",children:"Statut contributions"}),(0,d.jsx)("p",{className:"text-sm text-[#6b7280]",children:"Synth\xe8se des contributions et des collectes"}),(0,d.jsxs)("div",{className:"mt-6 space-y-3 text-sm text-[#171717]",children:[(0,d.jsxs)("p",{children:["Total collect\xe9: ",F.paidContributions.toFixed(2)," €"]}),(0,d.jsxs)("p",{children:["Campagnes suivies: ",F.campaignFunding.length]}),(0,d.jsxs)("p",{children:["Codes promo actifs: ",P.length]})]})]})]}),(0,d.jsxs)("div",{className:"rounded-2xl border border-[#e5e7eb] bg-white p-6",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{className:"text-2xl font-black",children:"Commandes r\xe9centes"}),(0,d.jsxs)("p",{className:"text-sm text-[#6b7280]",children:[ad," commande(s) en attente — focus sur les 4 derni\xe8res commandes"]})]}),(0,d.jsx)("button",{type:"button",onClick:()=>void b.push("/admin/orders"),className:"text-xs font-bold text-[#6b7280] uppercase",children:"Voir tout"})]}),(0,d.jsx)("div",{className:"mt-4 overflow-x-auto",children:(0,d.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,d.jsx)("thead",{className:"text-xs uppercase tracking-wider text-[#6b7280]",children:(0,d.jsxs)("tr",{className:"border-b border-[#eceff2]",children:[(0,d.jsx)("th",{className:"py-3",children:"Commande"}),(0,d.jsx)("th",{className:"py-3",children:"Montant"}),(0,d.jsx)("th",{className:"py-3",children:"Type"}),(0,d.jsx)("th",{className:"py-3",children:"Statut"})]})}),(0,d.jsx)("tbody",{className:"divide-y divide-[#f2f4f7] text-sm",children:ae.length?ae.map(a=>(0,d.jsxs)("tr",{className:"hover:bg-[#f8f8f5]",children:[(0,d.jsxs)("td",{className:"py-3 font-semibold",children:["#",a.id.slice(-6)]}),(0,d.jsxs)("td",{className:"py-3",children:[a.total.toFixed(2)," €"]}),(0,d.jsx)("td",{className:"py-3",children:u(a.saleType)}),(0,d.jsx)("td",{className:"py-3 uppercase text-xs text-[#181810]",children:w(a.status)})]},a.id)):(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:4,className:"py-6 text-center text-sm text-[#6b7280]",children:"Pas de commandes \xe0 afficher."})})})]})})]})]}):null,"users"===ab&&(0,d.jsxs)(z,{title:"Utilisateurs",subtitle:"Comptes, r\xf4les et permissions",actions:(0,d.jsx)("button",{type:"button",onClick:()=>void ar("/api/admin/users","users.csv"),className:"rounded border border-[#d8d7d0] px-3 py-1 text-xs font-semibold",children:"Exporter CSV"}),children:[(0,d.jsx)(s,{value:Z.users,onChange:a=>{$(b=>({...b,users:a})),aa(a=>({...a,users:1}))},placeholder:"Rechercher nom, e-mail, r\xf4le..."}),(0,d.jsx)(A,{headers:["Nom","E-mail","R\xf4le","Action"],rows:al.items.map(a=>[a.name,a.email,x(a.role),(0,d.jsx)("select",{className:"rounded border border-[#d8d7d0] px-2 py-1",value:a.role,onChange:b=>void at(a.id,b.target.value),children:o.map(a=>(0,d.jsx)("option",{value:a,children:x(a)},a))},a.id)])}),(0,d.jsx)(t,{page:_.users,totalPages:al.totalPages,onChange:a=>aa(b=>({...b,users:a}))})]}),"orders"===ab&&(0,d.jsxs)(z,{id:"orders-section",title:"Commandes",subtitle:"Historique et mise \xe0 jour des statuts",actions:(0,d.jsx)("button",{type:"button",onClick:()=>void ar("/api/admin/orders","orders.csv"),className:"rounded border border-[#d8d7d0] px-3 py-1 text-xs font-semibold",children:"Exporter CSV"}),children:[(0,d.jsx)(s,{value:Z.orders,onChange:a=>{$(b=>({...b,orders:a})),aa(a=>({...a,orders:1}))},placeholder:"Rechercher id, user, type, statut..."}),(0,d.jsx)(A,{headers:["Commande","Utilisateur","Total","Type","Statut"],rows:am.items.map(a=>[`${a.id.slice(0,10)}...`,`${a.userId.slice(0,10)}...`,`${a.total.toFixed(2)} €`,u(a.saleType),(0,d.jsx)("select",{className:"rounded border border-[#d8d7d0] px-2 py-1",value:a.status,onChange:b=>void au(a.id,b.target.value),children:m.map(a=>(0,d.jsx)("option",{value:a,children:w(a)},a))},a.id)])}),(0,d.jsx)(t,{page:_.orders,totalPages:am.totalPages,onChange:a=>aa(b=>({...b,orders:a}))})]}),"contributions"===ab&&(0,d.jsxs)(z,{title:"Contributions",subtitle:"Campagnes participatives et suivi des statuts",actions:(0,d.jsx)("button",{type:"button",onClick:()=>void ar("/api/admin/contributions","contributions.csv"),className:"rounded border border-[#d8d7d0] px-3 py-1 text-xs font-semibold",children:"Exporter CSV"}),children:[(0,d.jsx)(s,{value:Z.contributions,onChange:a=>{$(b=>({...b,contributions:a})),aa(a=>({...a,contributions:1}))},placeholder:"Rechercher id, livre, user, statut..."}),(0,d.jsx)(A,{headers:["Contribution","Livre","Utilisateur","Montant","Statut"],rows:an.items.map(a=>[`${a.id.slice(0,10)}...`,`${a.bookId.slice(0,10)}...`,a.userId?`${a.userId.slice(0,10)}...`:"Anonyme",`${a.amount.toFixed(2)} €`,(0,d.jsx)("select",{className:"rounded border border-[#d8d7d0] px-2 py-1",value:a.status,onChange:b=>void av(a.id,b.target.value),children:n.map(a=>{var b;return(0,d.jsx)("option",{value:a,children:"pending"===(b=a)?"En attente":"paid"===b?"Pay\xe9e":"Rembours\xe9e"},a)})},a.id)])}),(0,d.jsx)(t,{page:_.contributions,totalPages:an.totalPages,onChange:a=>aa(b=>({...b,contributions:a}))})]}),"ouvrages"===ab&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(z,{title:"Ajouter un ouvrage",subtitle:"Pr\xe9pare les prochains titres",children:(0,d.jsxs)("form",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",onSubmit:az,children:[(0,d.jsx)("input",{className:"rounded border border-[#d8d7d0] px-3 py-2",placeholder:"Titre",value:V.title,onChange:a=>{var b;return b=a.target.value,void W(a=>({...a,title:b,slug:X?a.slug:l(b)}))},required:!0}),(0,d.jsx)("input",{className:"rounded border border-[#d8d7d0] px-3 py-2",placeholder:"Slug (auto depuis le titre)",value:V.slug,onChange:a=>{var b;return b=a.target.value,void(Y(!0),W(a=>({...a,slug:l(b)})))}}),(0,d.jsx)("input",{className:"rounded border border-[#d8d7d0] px-3 py-2 md:col-span-2",placeholder:"Sous-titre (optionnel)",value:V.subtitle,onChange:a=>W(b=>({...b,subtitle:a.target.value}))}),(0,d.jsx)("input",{className:"rounded border border-[#d8d7d0] px-3 py-2",placeholder:"Prix",type:"number",min:0,step:"0.01",value:V.price,onChange:a=>W(b=>({...b,price:a.target.value})),required:!0}),(0,d.jsxs)("select",{className:"rounded border border-[#d8d7d0] px-3 py-2",value:V.saleType,onChange:a=>W(b=>({...b,saleType:a.target.value})),children:[(0,d.jsx)("option",{value:"direct",children:"Achat direct"}),(0,d.jsx)("option",{value:"preorder",children:"Pr\xe9commande"}),(0,d.jsx)("option",{value:"crowdfunding",children:"Financement participatif"})]}),(0,d.jsx)("input",{className:"rounded border border-[#d8d7d0] px-3 py-2",placeholder:"Date de sortie (YYYY-MM-DD)",type:"date",value:V.releaseDate,onChange:a=>W(b=>({...b,releaseDate:a.target.value}))}),(0,d.jsxs)("select",{className:"rounded border border-[#d8d7d0] px-3 py-2",value:V.coverVariant,onChange:a=>W(b=>({...b,coverVariant:a.target.value})),children:[(0,d.jsx)("option",{value:"featured",children:"Style couverture: Vedette"}),(0,d.jsx)("option",{value:"standard",children:"Style couverture: Standard"})]}),(0,d.jsx)("p",{className:"rounded border border-[#d8d7d0] bg-[#f8f8f5] px-3 py-2 text-xs text-[#6b7280] md:col-span-2",children:"La couverture est g\xe9n\xe9r\xe9e automatiquement selon le style choisi."}),(0,d.jsx)("textarea",{className:"rounded border border-[#d8d7d0] px-3 py-2 md:col-span-2",placeholder:"Description",value:V.description,onChange:a=>W(b=>({...b,description:a.target.value})),required:!0}),(0,d.jsx)("input",{className:"rounded border border-[#d8d7d0] px-3 py-2",placeholder:"ISBN (optionnel)",value:V.isbn,onChange:a=>W(b=>({...b,isbn:a.target.value}))}),(0,d.jsx)("input",{className:"rounded border border-[#d8d7d0] px-3 py-2",placeholder:"Stock (achat direct/precommande)",type:"number",min:0,required:"crowdfunding"!==V.saleType,value:V.stock,onChange:a=>W(b=>({...b,stock:a.target.value}))}),(0,d.jsx)("input",{className:"rounded border border-[#d8d7d0] px-3 py-2",placeholder:"Objectif financement (crowdfunding)",type:"number",min:0,required:"crowdfunding"===V.saleType,value:V.fundingGoal,onChange:a=>W(b=>({...b,fundingGoal:a.target.value}))}),(0,d.jsx)("input",{className:"rounded border border-[#d8d7d0] px-3 py-2",placeholder:"Montant collecte (suivi)",type:"number",min:0,value:V.fundingRaised,onChange:a=>W(b=>({...b,fundingRaised:a.target.value}))}),(0,d.jsx)("button",{className:"rounded-lg bg-primary px-4 py-2 text-sm font-bold uppercase md:col-span-2",children:"Cr\xe9er ouvrage"})]})}),(0,d.jsxs)(z,{title:"Catalogue en ligne",subtitle:"Stock, prix et collecte",children:[(0,d.jsx)(s,{value:Z.ouvrages,onChange:a=>{$(b=>({...b,ouvrages:a})),aa(a=>({...a,ouvrages:1}))},placeholder:"Rechercher titre, slug, type..."}),(0,d.jsx)(A,{headers:["Titre","Slug","Type","Prix","Stock/Objectif","Collect\xe9","Actions"],rows:ao.items.map(a=>[a.title,a.slug,u(a.saleType),`${a.price.toFixed(2)} €`,"crowdfunding"===a.saleType?`${(a.fundingGoal??0).toFixed(0)}`:`${(a.stock??0).toFixed(0)}`,`${(a.fundingRaised??0).toFixed(0)}`,(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(f(),{href:`/ouvrages/${a.slug}`,className:"rounded border border-[#d8d7d0] px-2 py-1 text-xs font-semibold",target:"_blank",children:"Voir"}),(0,d.jsx)("button",{type:"button",onClick:()=>void aw(a.id),className:"rounded border border-red-200 px-2 py-1 text-xs font-semibold text-red-700",children:"Supprimer"})]},a.id)])}),(0,d.jsx)(t,{page:_.ouvrages,totalPages:ao.totalPages,onChange:a=>aa(b=>({...b,ouvrages:a}))})]})]}),"marketing"===ab&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(z,{title:"Cr\xe9er un code promo",subtitle:"Campagnes de fid\xe9lisation",children:(0,d.jsxs)("form",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",onSubmit:ax,children:[(0,d.jsx)("input",{className:"rounded border border-[#d8d7d0] px-3 py-2",placeholder:"Code (ex: SENAME15)",value:T.code,onChange:a=>U(b=>({...b,code:a.target.value.toUpperCase()})),required:!0}),(0,d.jsxs)("select",{className:"rounded border border-[#d8d7d0] px-3 py-2",value:T.type,onChange:a=>U(b=>({...b,type:a.target.value})),children:[(0,d.jsx)("option",{value:"percent",children:"Pourcentage"}),(0,d.jsx)("option",{value:"fixed",children:"Montant fixe"})]}),(0,d.jsx)("input",{className:"rounded border border-[#d8d7d0] px-3 py-2",type:"number",min:0,step:"0.01",placeholder:"Valeur",value:T.value,onChange:a=>U(b=>({...b,value:a.target.value})),required:!0}),(0,d.jsx)("input",{className:"rounded border border-[#d8d7d0] px-3 py-2",type:"number",min:0,step:"0.01",placeholder:"Minimum panier",value:T.minSubtotal,onChange:a=>U(b=>({...b,minSubtotal:a.target.value}))}),(0,d.jsx)("input",{className:"rounded border border-[#d8d7d0] px-3 py-2",type:"number",min:0,step:"0.01",placeholder:"Plafond remise (optionnel)",value:T.maxDiscount,onChange:a=>U(b=>({...b,maxDiscount:a.target.value}))}),(0,d.jsx)("input",{className:"rounded border border-[#d8d7d0] px-3 py-2",type:"number",min:1,placeholder:"Limite d'utilisation (optionnel)",value:T.usageLimit,onChange:a=>U(b=>({...b,usageLimit:a.target.value}))}),(0,d.jsx)("input",{className:"rounded border border-[#d8d7d0] px-3 py-2 md:col-span-2",type:"date",value:T.expiresAt,onChange:a=>U(b=>({...b,expiresAt:a.target.value}))}),(0,d.jsx)("button",{className:"rounded-lg bg-primary px-4 py-2 text-sm font-bold uppercase",children:"Cr\xe9er le code promo"})]})}),(0,d.jsxs)(z,{title:"Codes promo",subtitle:"Actifs et statuts",children:[(0,d.jsx)(s,{value:Z.promos,onChange:a=>{$(b=>({...b,promos:a})),aa(a=>({...a,promos:1}))},placeholder:"Rechercher code, type, statut..."}),(0,d.jsx)(A,{headers:["Code","Type","Valeur","Usage","Minimum","Expiration","Actif"],rows:ap.items.map(a=>[a.code,"percent"===a.type?"Pourcentage":"Fixe","percent"===a.type?`${a.value}%`:`${a.value.toFixed(2)} €`,`${a.usedCount}${a.usageLimit?` / ${a.usageLimit}`:""}`,`${a.minSubtotal.toFixed(2)} €`,a.expiresAt?new Date(a.expiresAt).toLocaleDateString("fr-FR"):"-",(0,d.jsx)("button",{type:"button",onClick:()=>void ay(a),className:`rounded border px-2 py-1 text-xs font-semibold ${a.active?"border-green-200 text-green-700":"border-[#d8d7d0] text-[#6b7280]"}`,children:a.active?"Actif":"Inactif"},a.id)])}),(0,d.jsx)(t,{page:_.promos,totalPages:ap.totalPages,onChange:a=>aa(b=>({...b,promos:a}))})]})]})]})]})]})})}function r(a,b,c){let d=Math.max(1,Math.ceil(a.length/c)),e=(Math.min(Math.max(1,b),d)-1)*c;return{items:a.slice(e,e+c),totalPages:d}}function s({value:a,onChange:b,placeholder:c}){return(0,d.jsx)("div",{className:"mb-4",children:(0,d.jsx)("input",{className:"w-full rounded border border-[#d8d7d0] px-3 py-2 text-sm",value:a,onChange:a=>b(a.target.value),placeholder:c})})}function t({page:a,totalPages:b,onChange:c}){return(0,d.jsxs)("div",{className:"mt-4 flex items-center justify-end gap-3",children:[(0,d.jsx)("button",{onClick:()=>c(Math.max(1,a-1)),disabled:a<=1,className:"rounded border border-[#d8d7d0] px-3 py-1 text-xs font-semibold disabled:opacity-50",children:"Pr\xe9c\xe9dent"}),(0,d.jsxs)("span",{className:"text-xs text-[#6b7280]",children:["Page ",a," / ",b]}),(0,d.jsx)("button",{onClick:()=>c(Math.min(b,a+1)),disabled:a>=b,className:"rounded border border-[#d8d7d0] px-3 py-1 text-xs font-semibold disabled:opacity-50",children:"Suivant"})]})}function u(a){return"direct"===a?"Achat direct":"preorder"===a?"Pr\xe9commande":"Financement participatif"}function v(a){return a.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;")}function w(a){return"pending"===a?"En attente":"paid"===a?"Pay\xe9e":"cancelled"===a?"Annul\xe9e":"Rembours\xe9e"}function x(a){return"admin"===a?"Administrateur":"Client"}function y({icon:a,label:b,value:c}){return(0,d.jsxs)("div",{className:"rounded-2xl border border-[#e5e7eb] bg-white p-5",children:[(0,d.jsx)("div",{className:"mb-3 flex h-10 w-10 items-center justify-center rounded-xl bg-[#fff8b5]",children:(0,d.jsx)("span",{className:"material-symbols-outlined text-[20px]",children:a})}),(0,d.jsx)("p",{className:"text-sm text-[#6b7280]",children:b}),(0,d.jsx)("p",{className:"mt-1 text-3xl font-black",children:c})]})}function z({title:a,subtitle:b,actions:c,id:e,children:f}){return(0,d.jsxs)("section",{id:e,className:"rounded-2xl border border-[#e5e7eb] bg-white p-4 sm:p-6",children:[(0,d.jsxs)("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-3",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{className:"text-xl font-black sm:text-2xl",children:a}),b?(0,d.jsx)("p",{className:"text-xs text-[#6b7280] sm:text-sm",children:b}):null]}),c?(0,d.jsx)("div",{className:"flex flex-wrap gap-2",children:c}):null]}),f]})}function A({headers:a,rows:b}){return(0,d.jsx)("div",{className:"overflow-x-auto",children:(0,d.jsxs)("table",{className:"w-full min-w-[760px] text-sm",children:[(0,d.jsx)("thead",{children:(0,d.jsx)("tr",{className:"border-b border-[#eceff2] text-left text-xs uppercase tracking-wider text-[#6b7280]",children:a.map(a=>(0,d.jsx)("th",{className:"py-2",children:a},a))})}),(0,d.jsx)("tbody",{children:b.map((a,b)=>(0,d.jsx)("tr",{className:"border-b border-[#f2f4f7]",children:a.map((a,b)=>(0,d.jsx)("td",{className:"py-2",children:a},b))},b))})]})})}},42378:(a,b,c)=>{"use strict";var d=c(91330);c.o(d,"usePathname")&&c.d(b,{usePathname:function(){return d.usePathname}}),c.o(d,"useRouter")&&c.d(b,{useRouter:function(){return d.useRouter}}),c.o(d,"useSearchParams")&&c.d(b,{useSearchParams:function(){return d.useSearchParams}})},51472:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>g,dynamic:()=>e,metadata:()=>f});var d=c(75338);c(61135);let e="force-dynamic",f={title:"SENAME EDITION’S",description:"Projet SENAME EDITION’S en Next.js"};function g({children:a}){return(0,d.jsxs)("html",{lang:"fr",children:[(0,d.jsxs)("head",{children:[(0,d.jsx)("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),(0,d.jsx)("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:""}),(0,d.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600;700;800&display=swap",rel:"stylesheet"}),(0,d.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@100..700&display=swap",rel:"stylesheet"})]}),(0,d.jsx)("body",{className:"font-display bg-background-light text-[#181810]",children:a})]})}},61134:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,81170,23)),Promise.resolve().then(c.t.bind(c,23597,23)),Promise.resolve().then(c.t.bind(c,36893,23)),Promise.resolve().then(c.t.bind(c,89748,23)),Promise.resolve().then(c.t.bind(c,6060,23)),Promise.resolve().then(c.t.bind(c,7184,23)),Promise.resolve().then(c.t.bind(c,69576,23)),Promise.resolve().then(c.t.bind(c,73041,23)),Promise.resolve().then(c.t.bind(c,51384,23))},61135:()=>{},88699:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/moucharif/Documents/IAI-COURS/PersonalProject/ProjetV/Livreo/src/app/admin/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/moucharif/Documents/IAI-COURS/PersonalProject/ProjetV/Livreo/src/app/admin/page.tsx","default")},96033:()=>{}};